(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{7690:function(e,l,t){Promise.resolve().then(t.bind(t,1809))},1809:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return f}});var a=t(7437);let n={INIT_GAME:"INIT_GAME",MOVE:"MOVE",GAME_OVER:"GAME_OVER",ERROR:"ERROR"},s=(e,l)=>JSON.stringify({type:e,payload:l});var r=t(8472),o=t(5590),c=t(2265);let i={lightGreen:"bg-green-400",darkGreen:"bg-green-800",textWhite:"text-white",textBlack:"text-black",lightYellow:"bg-yellow-300"},d=["a","b","c","d","e","f","g","h"],u=e=>({p:"♟",r:"♜",n:"♞",b:"♝",q:"♛",k:"♚",P:"♙",R:"♖",N:"♘",B:"♗",Q:"♕",K:"♔"})[e.type]||"",h=e=>{let{socket:l,setWhichSide:t,setWhoseturn:h}=e,[b,f]=(0,c.useState)(new o.qQ),[x,g]=(0,c.useState)(b.board()),[m,p]=(0,c.useState)(null),[E,k]=(0,c.useState)(!1);(0,c.useEffect)(()=>{r.Z.get("http://localhost:8080/gamedata",{withCredentials:!0}).then(e=>{let l=e.data,a=new o.qQ(l.gameData.fen);f(a),g(a.board()),h(a.turn()),t(l.color)}).catch(e=>{var l;console.log(null===(l=e.response)||void 0===l?void 0:l.data)})},[]),(0,c.useEffect)(()=>{l&&(l.onmessage=e=>{let l=JSON.parse(e.data);switch(l.type){case n.INIT_GAME:let a=new o.qQ;f(a),g(a.board()),h(a.turn()),t(l.payload.color);break;case n.MOVE:let s=l.payload,r=new o.qQ(s);f(r),g(r.board()),h(r.turn()),k(!1);break;case n.ERROR:alert(l.payload),k(!1);break;case n.GAME_OVER:alert(l.payload);break;default:console.log(l)}})},[l]);let v=e=>{if(m){k(!0);try{l.send(s("MOVE",{move:{from:m,to:e}}))}catch(e){console.log("error on handleMove"),alert("Invalid move")}p(null)}else p(e)},w=(e,l)=>{v(d[e]+(8-l))};return(0,a.jsxs)("div",{className:"grid relative grid-cols-8 w-[32rem] border border-black",children:[E?(0,a.jsx)("div",{className:"absolute h-full w-full bg-[#c57c7c82] flex justify-center items-center",children:(0,a.jsx)("span",{className:"text-3xl",children:"Loading..."})}):null,null==x?void 0:x.map((e,l)=>e.map((e,t)=>(0,a.jsx)("div",{onClick:()=>{w(t,l)},className:"flex items-center justify-center h-16 w-16 ".concat((null==e?void 0:e.square)===m?i.lightYellow:(l+t)%2==0?i.lightGreen:i.darkGreen),children:e&&(0,a.jsx)("span",{className:"text-5xl cursor-pointer ".concat("w"===e.color?i.textWhite:i.textBlack),children:u(e)})},"".concat(l,"-").concat(t))))]})},b=()=>{let[e,l]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let e=new WebSocket("ws://localhost:8080");return e.onopen=()=>{console.log("socket opened"),l(e)},e.onclose=()=>{console.log("socket closed"),l(null)},()=>{e.close()}},[]),e};var f=()=>{let e=b(),[l,t]=(0,c.useState)(null),[n,r]=(0,c.useState)(null);return e?(0,a.jsxs)("div",{className:"border border-yellow-300 flex flex-col sm:flex-row items-center justify-around h-screen",children:[(0,a.jsx)(h,{setWhoseturn:r,socket:e,setWhichSide:t}),(0,a.jsxs)("div",{className:" h-full flex flex-col justify-center space-y-7",children:[l?(0,a.jsxs)("h2",{children:["You are ",l," side"]}):(0,a.jsx)("h2",{children:"Initialized the game"}),(0,a.jsx)("button",{onClick:()=>{t("initialize"),null==e||e.send(s("INIT_GAME"))},disabled:null!==l,className:"bg-blue-500 disabled:bg-slate-500 disabled:cursor-not-allowed text-white text-lg font-semibold py-3 px-6 rounded-md hover:bg-blue-600 active:bg-blue-700",children:"Start Match"}),n?(0,a.jsxs)("h2",{children:["b"===n?"Black":"White"," turn"]}):null]})]}):(0,a.jsx)("div",{children:"Connecting..."})}}},function(e){e.O(0,[472,590,971,23,744],function(){return e(e.s=7690)}),_N_E=e.O()}]);